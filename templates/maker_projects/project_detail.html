{% extends "base.html" %}

{% block content %}
<article class="project-card">
  <h1>{{ project.title }}</h1>
  <p>
    Maker:
    <a href="{% url 'accounts:profile' project.owner.username %}">
      {{ project.owner.profile.display_name|default:project.owner.username }}
    </a>
  </p>

  <p class="project-date">
    Created {{ project.created_at|date:"F j, Y" }} |
    Due {{ project.due_date }}
  </p>
  <p class="badge {{ project.status|lower }}">
    Status: {{ project.status }}
  </p>
  
<div>
  {% if project.image %}
  <img src="{{ project.image.url }}" alt="{{ project.title }}">
  {% endif %}
</div>
  <section class="project-description">
    <h3>Description: </h3>
    <p>{{ project.description }}</p>
  </section>

<ul>
  {% for link in project.links.all %}
    <li>
      <a href="{{ link.url }}" target="_blank" rel="noopener noreferrer">
        {{ link.get_link_type_display }}
      </a>
    </li>
  {% endfor %}
</ul>


<br></br>
  <section class="checkpoints">
    <h3>Checkpoints: </h3>

    <ul>
      {% for checkpoint in project.checkpoints.all %}
      <li>
        <div class="checkpoint {% if checkpoint.is_complete %}done{% endif %}" id="checkpoint-{{ checkpoint.id }}">

          <input type="checkbox" class="checkpoint-toggle" data-id="{{ checkpoint.id }}">
          {% if checkpoint.is_complete%}checked{% endif %} </input>

          <strong>{{ checkpoint.title }}</strong>
          <p>{{ checkpoint.description }}</p>

          {% if user == project.owner %}
          <div class="checkpoint-actions">
            <a href="{% url 'maker_projects:checkpoint_edit' checkpoint.pk %}">
              Edit
            </a>
            |
            <a href="{% url 'maker_projects:checkpoint_delete' checkpoint.pk %}">
              Delete
            </a>
            {% endif %}
          </div>
        </div>
        </div>
      </li>
      {% empty %}
      <li>No checkpoints yet.</li>
      {% endfor %}
    </ul>

    {% if user == project.owner %}
    <a href="{% url 'maker_projects:checkpoint_create' project.pk %}">
      + Add Checkpoint
    </a>
    {% endif %}
  </section>
<br></br>
  {% if user == project.owner %}
  <a href="{% url 'maker_projects:edit' project.pk %}">Edit</a> |
  <a href="{% url 'maker_projects:delete' project.pk %}">Delete</a> |
  <a href="{% url 'maker_projects:confirm_complete' project.pk %}">Complete</a>
  {% endif %}

 <br></br>

 <form action="{% url 'maker_projects:project_like' project.pk %}" method="post">
  {% csrf_token %}
  <button type="submit">
    LIKES {{ project.likes.count }}
  </button>
</form>


</article>
{% endblock %}